---
import { PROFILE } from "@site-config"
import { getProjectsForIndex } from "@/lib/projects"
import Layout from "@/layouts/Layout.astro"
import Breadcrumbs from "@/components/layout/Breadcrumbs.astro"
import { GithubActivity, ProjectCard } from "@/components/projects"

const { featuredProjects, otherProjects } = await getProjectsForIndex()

// Get GitHub URL for GithubActivity
const githubUrl =
  typeof PROFILE.links.github === "string"
    ? PROFILE.links.github
    : PROFILE.links.github?.href || "https://github.com"
---

<Layout class="max-w-3xl" title="Projects">
  <Breadcrumbs items={[{ label: "Projects", icon: "folder-open" }]} />

  <section class="mb-8">
    <h1 class="mb-4 text-3xl font-bold">Projects</h1>
    <p class="text-muted-foreground">
      A collection of projects I've worked on, ranging from academic research to personal
      explorations. If you think it would be useful or interesting to collaborate on a project,
      please contact me to discuss.
    </p>
  </section>

  <div class="flex flex-col gap-8">
    {/* Featured Projects */}
    {
      featuredProjects.length > 0 && (
        <section>
          <h2 class="mb-4 text-2xl font-semibold">Featured Projects</h2>
          <div class="grid gap-4 md:grid-cols-1 lg:grid-cols-2">
            {featuredProjects.map((project) => (
              <ProjectCard {project} />
            ))}
          </div>
        </section>
      )
    }

    {/* Other Projects */}
    {
      otherProjects.length > 0 && (
        <section>
          <h2 class="mb-4 text-2xl font-semibold">Other Projects</h2>
          <div class="grid gap-4 md:grid-cols-1 lg:grid-cols-2">
            {otherProjects.map((project) => (
              <ProjectCard {project} />
            ))}
          </div>
        </section>
      )
    }

    {/* GitHub Activity */}
    <GithubActivity githubUrl={githubUrl} />
  </div>
</Layout>
