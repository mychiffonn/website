---
import type { ProcessedPublication } from "@/schemas"

import { loadAllPublications } from "@/lib/publications/loader"
import CommonLayout from "@/layouts/CommonLayout.astro"
import Section from "@/components/layout/Section.astro"
import PubCard from "@/components/publications/PubCard.astro"

const { publicationsByYear, years } = await loadAllPublications()
---

<CommonLayout
  title="Publications"
  description="Publications, preprints, and conference tutorials"
  breadcrumbs={[{ label: "Publications", icon: "research" }]}
  prose={false}
>
  {
    years.length > 0 ? (
      years.map((year) => (
        <Section title={year.toString()}>
          {publicationsByYear[year].map((pub: ProcessedPublication) => (
            <PubCard pub={pub} />
          ))}
        </Section>
      ))
    ) : (
      <div class="py-12 text-center">
        <h2 class="text-muted-foreground mb-2 text-xl font-medium">No publications found</h2>
        <p class="text-muted-foreground">
          Publications will appear here once they are added to the bibliography.
        </p>
      </div>
    )
  }
</CommonLayout>
