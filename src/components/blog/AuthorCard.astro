---
import type { AuthorData } from "@/lib/blog/types"
import { cn } from "@/lib/utils"
import ProfileLinks from "@/components/profile/ProfileLinks.astro"

import AuthorAvatar from "./AuthorAvatar.astro"

import "@/assets/styles/card.css"

interface Props {
  author: AuthorData
}

const { author } = Astro.props
const { id, name, bio, pronouns, links } = author
const isAuthorPage = Astro.url.pathname === `/authors/${id}`

// Add 'relative' and 'group' for the stretched-link pattern
const cardClasses = cn(
  "card relative flex flex-wrap gap-4 py-4",
  !isAuthorPage && "card-clickable group" // 'group' enables group-hover styles
)
---

<article class={cardClasses}>
  {
    !isAuthorPage && (
      <a
        href={`/authors/${id}`}
        class="absolute inset-0 z-0"
        aria-label={`View profile for ${name}`}
      />
    )
  }

  <AuthorAvatar author={author} fallbackStyle="all-initials" width={40} class="relative size-40" />

  <div class="relative flex grow flex-col justify-between gap-y-4">
    <div>
      <div class="flex flex-wrap items-center gap-x-2">
        <h3 class="text-lg font-medium">{name}</h3>
        {pronouns && <span class="text-muted-foreground text-sm">({pronouns})</span>}
      </div>
      <p class="text-muted-foreground text-sm">{bio}</p>
    </div>

    <ProfileLinks links={links} />
  </div>
</article>
